import{d as e,r as t,C as a,D as l,z as n,H as i,I as o,o as s,h as r,w as m,g as u,a as c,B as d,t as f,K as p,y as g,c as _,G as y,F as h,k as b,E as w}from"./index-c922549f.js";import{a as k,E as j}from"./el-button-3322aa8d.js";/* empty css                        */import{E as v}from"./el-card-a447f2d0.js";import{a as x,E as C}from"./el-row-b1864fd0.js";import{E as T}from"./el-link-747b4ade.js";import{E}from"./el-message-box-e080817e.js";import"./el-input-5992562e.js";import"./el-overlay-51fc3bc1.js";import{E as D}from"./el-popper-777547bb.js";import{E as U}from"./el-popover-3ce8b172.js";import{E as z,a as S}from"./el-table-column-afd5a8b4.js";import"./el-checkbox-8ac95930.js";/* empty css               */import"./el-tooltip-4ed993c7.js";import{s as I,t as M}from"./index-51cc2b47.js";import{_ as B}from"./MeetingRoleDescription.vue_vue_type_script_setup_true_lang-19fecb77.js";const R={key:0,style:{"font-size":"small"}},V={key:1,style:{"font-size":"medium","font-weight":"bolder"}},F={key:0,style:{"font-size":"x-small"}},K={key:2,style:{"margin-left":"10px"}},L=e({__name:"MeetingSessionTable",props:{refreshVersion:{default:0},clubUuid:{default:""},meetingUuid:{default:""}},emits:["create","edit","show-role","change-format"],setup(e,{emit:L}){const W=e,{t:X}=b(),A=t([]),G=t(0),H=t(!1),J=t({offset:0,limit:1e3}),N=async()=>{try{if(H.value=!0,!W.clubUuid||!W.meetingUuid)throw"club or meeting not specified";const e={club:W.clubUuid,meeting:W.meetingUuid,...c(J)};let t=null;const a=[],l=await I(e);for(const n of l.results){null===t&&(t=new Date(n.meeting_time||""));const e=n.duration.split(":"),l=parseInt(e[0]),i=parseInt(e[1]),o=1e3*(60*(60*l+i)+parseInt(e[2])),s=new Date(t.getTime()),r=new Date(t.getTime()+o);t.setTime(r.getTime()),a.push({time_begin:s,time_end:r,...n})}G.value=l.count||0,A.value=a}catch(e){G.value=0,A.value=[]}finally{H.value=!1}},O=({row:e})=>e.is_highlighted?"title-row":"";return a((()=>W.refreshVersion),(async()=>{await N()})),a((()=>W.clubUuid),(async()=>{await N()})),l((()=>{N()})),n((()=>{N()})),(e,t)=>{const a=i("Icon"),l=o("loading");return s(),r(c(x),null,{default:m((()=>[u(c(C),{span:24},{default:m((()=>[u(c(v),{"body-style":"padding: 0"},{header:m((()=>[u(c(x),null,{default:m((()=>[u(c(k),null,{default:m((()=>[u(c(j),{type:"primary",onClick:t[0]||(t[0]=e=>{L("create")})},{default:m((()=>[d(f(c(X)("exampleDemo.add")),1)])),_:1}),u(c(j),{onClick:t[1]||(t[1]=e=>N())},{default:m((()=>[u(a,{icon:"material-symbols:refresh"})])),_:1}),u(c(j),{onClick:t[2]||(t[2]=e=>{L("change-format")})},{default:m((()=>[u(c(D),{content:c(X)("meetings.meetingRole"),placement:"top"},{default:m((()=>[u(a,{icon:"material-symbols:group"})])),_:1},8,["content"])])),_:1})])),_:1})])),_:1})])),default:m((()=>[p((s(),r(c(z),{data:A.value,"row-class-name":O},{default:m((()=>[u(c(S),{label:c(X)("common.startTimeText"),align:"center"},{default:m((({row:e})=>["00:00:00"!==e.duration?(s(),r(c(x),{key:0},{default:m((()=>[u(c(C),{style:{"font-size":"small"}},{default:m((()=>[d(f(new Date(e.time_begin).toLocaleString().split(",")[1]),1)])),_:2},1024)])),_:2},1024)):g("",!0)])),_:1},8,["label"]),u(c(S),{label:c(X)("meetings.meetingSession"),align:"center"},{default:m((({row:e})=>[e.is_highlighted?(s(),_("span",V,f(e.name),1)):(s(),_("span",R,f(e.name),1))])),_:1},8,["label"]),u(c(S),{label:c(X)("meetings.meetingDuration"),align:"center"},{default:m((({row:e})=>["00:00:00"!==e.duration?(s(),r(c(x),{key:0},{default:m((()=>[u(c(C),{style:{"font-size":"small"}},{default:m((()=>[d(f(e.duration),1)])),_:2},1024)])),_:2},1024)):g("",!0)])),_:1},8,["label"]),u(c(S),{label:c(X)("meetings.meetingRole"),align:"center"},{default:m((({row:e})=>[(s(!0),_(h,null,y(e.meeting_roles,(e=>(s(),r(c(x),{key:e.uuid,justify:"center"},{default:m((()=>[e.title?(s(),_("span",F,f(e.title),1)):g("",!0),e.participant_name?(s(),r(c(U),{key:1,width:200,placement:"left",onShow:t=>e.refresh_version=Math.random()},{reference:m((()=>[u(c(T),{style:{"margin-left":"10px"}},{default:m((()=>[d(f(e.participant_name),1)])),_:2},1024)])),default:m((()=>[u(B,{"refresh-version":e.refresh_version,"meeting-role-uuid":e.uuid},null,8,["refresh-version","meeting-role-uuid"])])),_:2},1032,["onShow"])):(s(),_("span",K," N/A "))])),_:2},1024)))),128))])),_:1},8,["label"]),u(c(S),{label:c(X)("common.action"),align:"center"},{default:m((({row:e})=>[u(c(k),null,{default:m((()=>[u(c(j),{onClick:t=>(e=>{L("show-role",c(e))})(e)},{default:m((()=>[u(a,{icon:"material-symbols:group"})])),_:2},1032,["onClick"]),u(c(j),{onClick:t=>(e=>{L("edit",c(e))})(e)},{default:m((()=>[u(a,{icon:"ep:edit"})])),_:2},1032,["onClick"]),u(c(j),{type:"danger",onClick:t=>(async e=>{try{await E.confirm(X("common.delMessage"),X("common.delWarning"),{confirmButtonText:X("common.ok"),cancelButtonText:X("common.cancel"),type:"warning"})}catch(t){return}try{await M(e.uuid),w({type:"success",message:X("common.delSuccess")})}catch(t){w({type:"error",message:X("common.delFailed")})}await N()})(e)},{default:m((()=>[u(a,{icon:"ep:delete"})])),_:2},1032,["onClick"])])),_:2},1024)])),_:1},8,["label"])])),_:1},8,["data"])),[[l,H.value]])])),_:1})])),_:1})])),_:1})}}});export{L as _};
