import{d as e,r as a,v as t,a as l,C as n,D as o,z as s,H as i,I as r,o as c,h as m,w as u,g as d,J as p,B as f,t as g,K as _,x as y,k as b,E as h}from"./index-c922549f.js";import{a as v,E as w}from"./el-button-3322aa8d.js";/* empty css                        */import{E as j}from"./el-card-a447f2d0.js";import{a as k,E as x}from"./el-row-b1864fd0.js";import{E as C}from"./el-input-5992562e.js";import{E}from"./el-link-747b4ade.js";import{E as z}from"./el-message-box-e080817e.js";import"./el-overlay-51fc3bc1.js";import{E as T}from"./el-pagination-952f169c.js";/* empty css               */import"./el-select-2d83cd87.js";import{E as U}from"./el-popper-777547bb.js";import{E as V,a as S}from"./el-table-column-afd5a8b4.js";import"./el-checkbox-8ac95930.js";import"./el-tooltip-4ed993c7.js";import{l as B,d as D}from"./index-51cc2b47.js";const K=e({__name:"MeetingTable",props:{refreshVersion:{default:0},clubUuid:{default:""}},emits:["change-format","create","edit","select"],setup(e,{emit:K}){const L=e,{t:M}=b(),I=a([]),J=a(0),W=a(!1),F=a({offset:0,limit:30,theme_contains:""}),H=t({get(){const e=l(F);return e.offset/e.limit+1},set(e){const a=l(F);a.offset=(e-1)*a.limit}}),P=t({get:()=>l(F).limit,set(e){l(F).limit=e}}),X=async()=>{try{W.value=!0;const e={club:L.clubUuid,...l(F)},a=await B(e);J.value=a.count||0,I.value=a.results}catch(e){J.value=0,I.value=[]}finally{W.value=!1}};return n((()=>L.refreshVersion),(async()=>{await X()})),n((()=>L.clubUuid),(async()=>{await X()})),o((()=>{X()})),s((()=>{X()})),(e,a)=>{const t=i("Icon"),n=r("loading");return c(),m(l(k),null,{default:u((()=>[d(l(x),{span:24},{default:u((()=>[d(l(j),{"body-style":"padding: 0"},{header:u((()=>[d(l(k),null,{default:u((()=>[d(l(C),{modelValue:F.value.theme_contains,"onUpdate:modelValue":a[0]||(a[0]=e=>F.value.theme_contains=e),placeholder:l(M)("meetings.meetingTheme"),style:{width:"200px","margin-right":"5px"},clearable:"",onKeydown:a[1]||(a[1]=p((e=>X()),["enter"]))},null,8,["modelValue","placeholder"]),d(l(v),null,{default:u((()=>[d(l(w),{type:"primary",onClick:a[2]||(a[2]=e=>{K("create")})},{default:u((()=>[f(g(l(M)("exampleDemo.add")),1)])),_:1}),d(l(w),{onClick:a[3]||(a[3]=e=>X())},{default:u((()=>[d(l(U),{content:l(M)("router.search"),placement:"top"},{default:u((()=>[d(t,{icon:"ep:search"})])),_:1},8,["content"])])),_:1}),d(l(w),{onClick:a[4]||(a[4]=e=>{K("change-format")})},{default:u((()=>[d(t,{icon:"material-symbols:calendar-month"})])),_:1})])),_:1})])),_:1})])),default:u((()=>[_((c(),m(l(V),{data:I.value},{default:u((()=>[d(l(S),{label:l(M)("common.name"),align:"center"},{default:u((({row:e})=>[d(l(E),{type:"primary",onClick:a=>(e=>{K("select",l(e))})(e)},{default:u((()=>[f(g(e.name),1)])),_:2},1032,["onClick"])])),_:1},8,["label"]),d(l(S),{label:l(M)("meetings.meetingTheme"),align:"center",prop:"theme"},null,8,["label"]),d(l(S),{label:l(M)("meetings.meetingTime"),align:"center"},{default:u((({row:e})=>[d(l(k),null,{default:u((()=>[d(l(x),{style:{"font-size":"small"}},{default:u((()=>[f(g(new Date(e.time).toLocaleString()),1)])),_:2},1024)])),_:2},1024)])),_:1},8,["label"]),d(l(S),{label:l(M)("meetings.venue"),align:"center","min-width":30},{default:u((({row:e})=>[d(l(U),{content:e.venue_address,placement:"top"},{default:u((()=>[e.venue_external?(c(),m(t,{key:1,icon:"material-symbols:location-on",style:{cursor:"pointer"},onClick:a=>(e=>{e.venue_external&&window.open(e.venue_external,"_blank")})(e)},null,8,["onClick"])):(c(),m(t,{key:0,icon:"material-symbols:location-on"}))])),_:2},1032,["content"])])),_:1},8,["label"]),d(l(S),{label:l(M)("common.createdBy"),align:"center"},{default:u((({row:e})=>[d(l(k),null,{default:u((()=>[d(l(x),null,{default:u((()=>[f(g(e.created_by),1)])),_:2},1024)])),_:2},1024),d(l(k),null,{default:u((()=>[d(l(x),{style:{"font-size":"x-small"}},{default:u((()=>[f(g(new Date(e.created_time).toLocaleString()),1)])),_:2},1024)])),_:2},1024)])),_:1},8,["label"]),d(l(S),{label:l(M)("common.action"),align:"center"},{default:u((({row:e})=>[d(l(v),null,{default:u((()=>[d(l(w),{onClick:a=>(e=>{K("edit",l(e))})(e)},{default:u((()=>[d(t,{icon:"ep:edit"})])),_:2},1032,["onClick"]),d(l(w),{type:"danger",onClick:a=>(async e=>{try{await z.confirm(M("common.delMessage"),M("common.delWarning"),{confirmButtonText:M("common.ok"),cancelButtonText:M("common.cancel"),type:"warning"})}catch(a){return}try{await D(e.uuid),h({type:"success",message:M("common.delSuccess")})}catch(a){h({type:"error",message:M("common.delFailed")})}await X()})(e)},{default:u((()=>[d(t,{icon:"ep:delete"})])),_:2},1032,["onClick"])])),_:2},1024)])),_:1},8,["label"])])),_:1},8,["data"])),[[n,W.value]]),d(l(T),{"current-page":l(H),"onUpdate:currentPage":a[5]||(a[5]=e=>y(H)?H.value=e:null),"page-size":l(P),"onUpdate:pageSize":a[6]||(a[6]=e=>y(P)?P.value=e:null),total:J.value,layout:"prev, pager, next, jumper, sizes, total",style:{margin:"10px"},onSizeChange:a[7]||(a[7]=e=>X()),onCurrentChange:a[8]||(a[8]=e=>X())},null,8,["current-page","page-size","total"])])),_:1})])),_:1})])),_:1})}}});export{K as _};
