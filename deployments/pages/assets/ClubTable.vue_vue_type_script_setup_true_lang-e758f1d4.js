import{d as e,v as a,r as t,a as l,C as o,z as n,H as s,I as r,o as i,h as m,w as c,g as u,J as p,B as d,t as f,K as g,L as y,M as b,N as _,x as h,k as j,E as v}from"./index-c922549f.js";import{a as w,E as C}from"./el-button-3322aa8d.js";/* empty css                        */import{E as x}from"./el-card-a447f2d0.js";import{a as k,E}from"./el-row-b1864fd0.js";import{E as z}from"./el-input-5992562e.js";import{E as V}from"./el-message-box-e080817e.js";import"./el-overlay-51fc3bc1.js";import{E as T}from"./el-pagination-952f169c.js";/* empty css               */import"./el-select-2d83cd87.js";import{E as U}from"./el-popper-777547bb.js";import{E as B,a as K}from"./el-table-column-afd5a8b4.js";import"./el-checkbox-8ac95930.js";import"./el-tooltip-4ed993c7.js";import{f as M,h as S}from"./index-ccc23f63.js";import{u as I}from"./preference-49f4d9d7.js";const L=e({__name:"ClubTable",props:{refreshVersion:{default:0}},emits:["create","edit"],setup(e,{emit:L}){const W=e,{t:D}=j(),F=I(),H=a({get:()=>F.getClub,set(e){F.setClub(e)}}),J=t([]),N=t(0),P=t(!1),X=t({offset:0,limit:100,name_contains:""}),q=a({get(){const e=l(X);return e.offset/e.limit+1},set(e){const a=l(X);a.offset=(e-1)*a.limit}}),A=a({get:()=>l(X).limit,set(e){l(X).limit=e}}),G=async()=>{try{P.value=!0;const e=await M(l(X));N.value=e.count||0,J.value=e.results}catch(e){N.value=0,J.value=[]}finally{P.value=!1}};return o((()=>W.refreshVersion),(async()=>{await G()})),n((()=>{G()})),(e,a)=>{const t=s("Icon"),o=r("loading");return i(),m(l(k),null,{default:c((()=>[u(l(E),{span:24},{default:c((()=>[u(l(x),{"body-style":"padding: 0"},{header:c((()=>[u(l(k),null,{default:c((()=>[u(l(z),{modelValue:X.value.name_contains,"onUpdate:modelValue":a[0]||(a[0]=e=>X.value.name_contains=e),placeholder:l(D)("common.name"),style:{width:"200px","margin-right":"5px"},clearable:"",onKeydown:a[1]||(a[1]=p((e=>G()),["enter"]))},null,8,["modelValue","placeholder"]),u(l(w),null,{default:c((()=>[u(l(C),{type:"primary",onClick:a[2]||(a[2]=e=>{L("create")})},{default:c((()=>[d(f(l(D)("exampleDemo.add")),1)])),_:1}),u(l(C),{onClick:a[3]||(a[3]=e=>G())},{default:c((()=>[u(l(U),{content:l(D)("router.search"),placement:"top"},{default:c((()=>[u(t,{icon:"ep:search"})])),_:1},8,["content"])])),_:1})])),_:1})])),_:1})])),default:c((()=>[g((i(),m(l(B),{data:J.value},{default:c((()=>[u(l(K),{label:l(D)("common.name"),align:"center",prop:"name"},null,8,["label"]),u(l(K),{label:l(D)("common.alias"),align:"center",prop:"alias","min-width":50},null,8,["label"]),u(l(K),{label:l(D)("common.description"),align:"center",prop:"intro"},null,8,["label"]),u(l(K),{label:l(D)("common.select"),align:"center","min-width":30},{default:c((({row:e})=>[u(l(y),{style:{cursor:"pointer"},onClick:a=>(e=>{H.value=e.uuid})(e)},{default:c((()=>[l(H)===e.uuid?(i(),m(l(b),{key:0,style:{color:"#67c23a"}})):(i(),m(l(_),{key:1}))])),_:2},1032,["onClick"])])),_:1},8,["label"]),u(l(K),{label:l(D)("common.action"),align:"center"},{default:c((({row:e})=>[u(l(w),null,{default:c((()=>[u(l(C),{onClick:a=>(e=>{L("edit",l(e))})(e)},{default:c((()=>[u(t,{icon:"ep:edit"})])),_:2},1032,["onClick"]),u(l(C),{type:"danger",onClick:a=>(async e=>{try{await V.confirm(D("common.delMessage"),D("common.delWarning"),{confirmButtonText:D("common.ok"),cancelButtonText:D("common.cancel"),type:"warning"})}catch(a){return}try{await S(e.uuid),v({type:"success",message:D("common.delSuccess")})}catch(a){v({type:"error",message:D("common.delFailed")})}await G()})(e)},{default:c((()=>[u(t,{icon:"ep:delete"})])),_:2},1032,["onClick"])])),_:2},1024)])),_:1},8,["label"])])),_:1},8,["data"])),[[o,P.value]]),u(l(T),{"current-page":l(q),"onUpdate:currentPage":a[4]||(a[4]=e=>h(q)?q.value=e:null),"page-size":l(A),"onUpdate:pageSize":a[5]||(a[5]=e=>h(A)?A.value=e:null),total:N.value,layout:"prev, pager, next, jumper, sizes, total",style:{margin:"10px"},onSizeChange:a[6]||(a[6]=e=>G()),onCurrentChange:a[7]||(a[7]=e=>G())},null,8,["current-page","page-size","total"])])),_:1})])),_:1})])),_:1})}}});export{L as _};
