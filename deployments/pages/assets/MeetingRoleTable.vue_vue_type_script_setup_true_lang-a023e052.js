import{d as e,r as a,C as t,D as l,z as n,H as o,I as i,o as s,h as c,w as r,g as u,a as m,B as d,t as p,K as f,y as g,k as _,E as y}from"./index-c922549f.js";import{a as b,E as w}from"./el-button-3322aa8d.js";/* empty css                        */import{E as j}from"./el-card-a447f2d0.js";import{a as h,E as k}from"./el-row-b1864fd0.js";import{E as x}from"./el-message-box-e080817e.js";import"./el-input-5992562e.js";import"./el-overlay-51fc3bc1.js";import{E as v,a as U}from"./el-table-column-afd5a8b4.js";import"./el-checkbox-8ac95930.js";/* empty css               */import"./el-tooltip-4ed993c7.js";import{E as C}from"./el-popper-777547bb.js";import{n as E,o as S}from"./index-51cc2b47.js";const B=e({__name:"MeetingRoleTable",props:{refreshVersion:{default:0},clubUuid:{default:""},meetingUuid:{default:""},excludeMeetingSessionUuid:{default:""},isSelecting:{type:Boolean,default:!1}},emits:["create","select","edit","change-format"],setup(e,{emit:B}){const M=e,{t:T}=_(),D=a([]),R=a(0),V=a(!1),z=a({offset:0,limit:1e3}),I=async()=>{try{if(V.value=!0,!M.clubUuid||!M.meetingUuid)throw"club or meeting not specified";const e={club:M.clubUuid,meeting:M.meetingUuid,meeting_session_exclude:M.excludeMeetingSessionUuid,...m(z)},a=await E(e);R.value=a.count||0,D.value=a.results}catch(e){R.value=0,D.value=[]}finally{V.value=!1}},K=e=>{B("select",m(e))};return t((()=>M.refreshVersion),(async()=>{await I()})),t((()=>M.clubUuid),(async()=>{await I()})),l((()=>{I()})),n((()=>{I()})),(a,t)=>{const l=o("Icon"),n=i("loading");return s(),c(m(h),null,{default:r((()=>[u(m(k),{span:24},{default:r((()=>[u(m(j),{"body-style":"padding: 0"},{header:r((()=>[u(m(h),null,{default:r((()=>[u(m(b),null,{default:r((()=>[u(m(w),{type:"primary",onClick:t[0]||(t[0]=e=>{B("create")})},{default:r((()=>[d(p(m(T)("exampleDemo.add")),1)])),_:1}),u(m(w),{onClick:t[1]||(t[1]=e=>I())},{default:r((()=>[u(l,{icon:"material-symbols:refresh"})])),_:1}),u(m(w),{onClick:t[2]||(t[2]=e=>{B("change-format")})},{default:r((()=>[u(m(C),{content:m(T)("meetings.meetingSession"),placement:"top"},{default:r((()=>[u(l,{icon:"material-symbols:view-agenda"})])),_:1},8,["content"])])),_:1})])),_:1})])),_:1})])),default:r((()=>[f((s(),c(m(v),{data:D.value,onRowClick:K},{default:r((()=>[u(m(U),{label:m(T)("meetings.meetingRole"),align:"center",prop:"title"},null,8,["label"]),u(m(U),{label:m(T)("participants.participant"),align:"center",prop:"participant_name"},null,8,["label"]),u(m(U),{label:m(T)("common.createdBy"),align:"center"},{default:r((({row:e})=>[u(m(h),null,{default:r((()=>[u(m(k),null,{default:r((()=>[d(p(e.created_by),1)])),_:2},1024)])),_:2},1024),u(m(h),null,{default:r((()=>[u(m(k),{style:{"font-size":"x-small"}},{default:r((()=>[d(p(new Date(e.created_time).toLocaleString()),1)])),_:2},1024)])),_:2},1024)])),_:1},8,["label"]),e.isSelecting?g("",!0):(s(),c(m(U),{key:0,label:m(T)("common.action"),align:"center"},{default:r((({row:e})=>[u(m(b),null,{default:r((()=>[u(m(w),{onClick:a=>(e=>{B("edit",m(e))})(e)},{default:r((()=>[u(l,{icon:"ep:edit"})])),_:2},1032,["onClick"]),u(m(w),{type:"danger",onClick:a=>(async e=>{try{await x.confirm(T("common.delMessage"),T("common.delWarning"),{confirmButtonText:T("common.ok"),cancelButtonText:T("common.cancel"),type:"warning"})}catch(a){return}try{await S(e.uuid),y({type:"success",message:T("common.delSuccess")})}catch(a){y({type:"error",message:T("common.delFailed")})}await I()})(e)},{default:r((()=>[u(l,{icon:"ep:delete"})])),_:2},1032,["onClick"])])),_:2},1024)])),_:1},8,["label"]))])),_:1},8,["data"])),[[n,V.value]])])),_:1})])),_:1})])),_:1})}}});export{B as _};
